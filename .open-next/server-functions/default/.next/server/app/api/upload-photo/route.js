(()=>{var e={};e.id=54,e.ids=[54],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},23870:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var s=r(55511);let o={randomUUID:s.randomUUID},n=new Uint8Array(256),a=n.length,i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).slice(1));let u=function(e,t,r){if(o.randomUUID&&!t&&!e)return o.randomUUID();let u=(e=e||{}).random??e.rng?.()??(a>n.length-16&&((0,s.randomFillSync)(n),a=0),n.slice(a,a+=16));if(u.length<16)throw Error("Random bytes length must be >= 16");if(u[6]=15&u[6]|64,u[8]=63&u[8]|128,t){if((r=r||0)<0||r+16>t.length)throw RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[r+e]=u[e];return t}return function(e,t=0){return(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase()}(u)}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},72698:(e,t,r)=>{"use strict";r.d(t,{Rv:()=>n,hD:()=>s,hS:()=>o});class s extends Error{constructor(e,t=500,r=null){super(e),this.name="ApiError",this.statusCode=t,this.details=r}}function o(e){return(console.error("API Error:",e),e instanceof s)?{success:!1,error:e.message,details:e.details,statusCode:e.statusCode}:{success:!1,error:e.message||"An unexpected error occurred",statusCode:500}}function n(e,t){let r=t.filter(t=>!e[t]);if(r.length>0)throw new s(`Missing required fields: ${r.join(", ")}`,400,{missingFields:r})}},78335:()=>{},87948:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>S,routeModule:()=>m,serverHooks:()=>x,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>w});var s={};r.r(s),r.d(s,{POST:()=>g});var o=r(96559),n=r(48088),a=r(37719),i=r(32190),u=r(91043),p=r(23870),d=r(72698);let c=void 0!==global.DOCUMENTS_BUCKET,l=c?null:new u.S3Client({region:process.env.S3_REGION||"auto",endpoint:process.env.S3_ENDPOINT,credentials:{accessKeyId:process.env.S3_ACCESS_KEY||"",secretAccessKey:process.env.S3_SECRET_KEY||""}}),h=process.env.S3_BUCKET_NAME||"mechanic-dispute-documents";async function g(e){try{let t=await e.formData(),r=t.get("photo"),s=t.get("case_id")||`case_${(0,p.A)().substring(0,8)}`;if(!r)throw new d.hD("No photo uploaded",400);if(r.size>0xa00000)throw new d.hD("File size exceeds the 10MB limit",400);let o=Buffer.from(await r.arrayBuffer()),n=`photo_${(0,p.A)().substring(0,8)}`,a=`${s}/${n}.${r.name.split(".").pop()}`;c?await global.DOCUMENTS_BUCKET.put(a,o,{httpMetadata:{contentType:r.type},customMetadata:{caseId:s,photoId:n,originalName:r.name,uploadDate:new Date().toISOString()}}):await l.send(new u.PutObjectCommand({Bucket:h,Key:a,Body:o,ContentType:r.type,Metadata:{caseId:s,photoId:n,originalName:r.name,uploadDate:new Date().toISOString()}}));let g=`/api/get-photo/${s}/${n}`;return i.NextResponse.json({success:!0,photoId:n,caseId:s,url:g})}catch(t){let e=(0,d.hS)(t);return i.NextResponse.json(e,{status:e.statusCode})}}let m=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/upload-photo/route",pathname:"/api/upload-photo",filename:"route",bundlePath:"app/api/upload-photo/route"},resolvedPagePath:"/Users/wlvar/Downloads/mechanicdisputecfworker (2)/app/api/upload-photo/route.js",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:f,workUnitAsyncStorage:w,serverHooks:x}=m;function S(){return(0,a.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:w})}},91043:e=>{"use strict";e.exports=require("@aws-sdk/client-s3")},96487:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,580],()=>r(87948));module.exports=s})();